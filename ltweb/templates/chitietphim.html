<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chi Tiết Phim</title>
    <link rel="stylesheet" href="/static/chitietphim.css">
</head>
<body>
    <!-- Navbar -->
    <div class="navbar">
        <div class="left">
            <a href="{{ url_for('homepage') }}">
                <img id="logo" src="{{ url_for('static', filename='logo2.svg') }}" alt="PopcornCinema Logo">
                <div class="logo-text">POPCORNCINEMA</div>
            </a>
        </div>
        
        <div class="menu">
            <a href="{{ url_for('rap') }}">RẠP PHIM</a>
            <a href="{{ url_for('myticket') }}">VÉ CỦA TÔI</a>
        </div>
        
        <div class="right">
            <div class="auth-links">
                {% if session.get('customerName') %}
                    <span>Hello, {{ session['customerName'] }}</span> |
                    <a href="{{ url_for('logout') }}">Logout</a>
                {% else %}
                    <a href="{{ url_for('login_page', form='login') }}">Đăng nhập</a> |
                    <a href="{{ url_for('login_page', form='signup') }}">Đăng ký</a>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="content">
        <div class="movie-details">
            <!-- Movie Image -->
            <div class="movie-image">
                <img src="{{ movie['poster'] }}" alt="Poster của {{ movie['name'] }}">
            </div>

            <!-- Movie Trailer -->
            <div class="movie-trailer">
                <iframe width="560" height="315" src="{{ movie['trailer'] }}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
            </div>
        </div>

        <div class="right-section">
            <!-- Movie Information -->
            <div class="movie-info">
                <h2>{{ movie['movieName'] }}</h2>
                <p><strong>Đạo diễn:</strong> {{ movie['director'] }}</p>
                <p><strong>Thể loại:</strong> {{ movie['genre'] }}</p>
                <p><strong>Khởi chiếu:</strong> {{ movie['date'] }}</p>
                <p><strong>Thời lượng:</strong> {{ movie['time'] }} phút</p>
                <p><strong>Ngôn ngữ:</strong> {{ movie['language'] }}</p>
                <p><strong>Rated:</strong> {{ movie['rated'] }} </p>
                <p><strong>Mô tả:</strong> {{ movie['description'] }}</p>
            </div>

            <!-- Rating and Buttons -->
            <div class="rating-and-buttons">
                <!-- Movie Rating -->
                <div class="rating">
                    {{ movie['score'] }}
                </div>

                <!-- Action Buttons -->
                <div class="button-gr">
                    <button onclick="toggleModal()">Đặt vé</button>
                    <button onclick="toggleForm('review-form')">Đánh giá</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Booking Modal -->
    <div class="overlay" id="bookingModal">
        <div class="modal">
            <!-- Date Selection -->
            <h2>Chọn lịch chiếu</h2>
            <div class="button-group" id="dateSelection">
                <button onclick="selectDate('5/11')">5/11</button>
                <button onclick="selectDate('6/11')">6/11</button>
                <button onclick="selectDate('7/11')">7/11</button>
                <button onclick="selectDate('8/11')">8/11</button>
                <button onclick="selectDate('9/11')">9/11</button>
                <button onclick="selectDate('10/11')">10/11</button>
            </div>

            <!-- Time Selection (Initially hidden) -->
            <h2 id="timeLabel" style="display: none;">Chọn giờ chiếu</h2>
            <div class="button-group" id="timeSelection" style="display: none;">
                <button onclick="selectTime('10:00')">10:00</button>
                <button onclick="selectTime('10:30')">10:30</button>
                <button onclick="selectTime('11:00')">11:00</button>
            </div>

            <!-- Confirm Booking Button (Initially hidden) -->
            <button id="confirmButton" style="display: none; margin: 20px;" onclick="confirmBooking()">Xác nhận đặt vé</button>
        </div>
    </div>

    <!--About us-->
    <div class="footer">
        <p>Made by Nguyễn Tiến Đạt, Hoàng Phong, Nguyễn Bảo</p>
        <p>Copyright © 2024 Popcorncinema</p>
    </div>

    <!-- JavaScript for Modal and Form Toggle -->
    <script>
        let selectedDate = null;
        let selectedTime = null;

        function toggleModal() {
            const modal = document.getElementById('bookingModal');
            modal.style.display = modal.style.display === 'none' || modal.style.display === '' ? 'flex' : 'none';
        }

        function toggleForm(formId) {
            const form = document.getElementById(formId);
            form.style.display = form.style.display === "none" ? "block" : "none";
        }

        function selectDate(date) {
            selectedDate = date;
            document.getElementById('timeLabel').style.display = 'block';
            document.getElementById('timeSelection').style.display = 'flex';
        }

        function selectTime(time) {
            selectedTime = time;
            document.getElementById('confirmButton').style.display = 'block';
        }

        function confirmBooking() {
            if (selectedDate && selectedTime) {
                alert(`Bạn đã chọn lịch chiếu vào ngày ${selectedDate} lúc ${selectedTime}.`);
                toggleModal(); // Đóng modal sau khi xác nhận
            } else {
                alert("Vui lòng chọn lịch chiếu và giờ chiếu trước khi xác nhận.");
            }
        }

        window.onclick = function(event) {
            const modal = document.getElementById('bookingModal');
            if (event.target === modal) {
                modal.style.display = 'none';
            }
        };
    </script>
</body>
</html>
